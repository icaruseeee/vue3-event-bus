import{version as t,provide as s,onBeforeUnmount as e,inject as i}from"vue";class n{constructor(t){this.strict=t&&!!t.length,this.strict&&(this.eventList=t),this.bus=new Map}validate(t){if(this.strict&&!this.eventList.includes(t))throw new Error("EventBus: Event type not supported under strict mode")}on(t,s){this.validate(t);const e=this.bus.get(t);e?e.push(s):this.bus.set(t,[s])}off(t,s){this.validate(t);const e=this.bus.get(t);e.length&&-1!==e.indexOf(s)&&e.splice(e.indexOf(s),1)}emit(t,s){this.validate(t);(this.bus.get(t)||[]).slice().forEach(t=>t(s))}clear(){this.bus.clear()}}const r=Symbol();function o(i){if(Number(t.split(".")[0])<3)throw new Error("EventBus: Only support Vue3+");const o=(t=>new n(t))(i);s(r,o),e(()=>{o.clear()})}function u(){const t=i(r);if(!t)throw new Error("EventBus: No event bus provided");return t}export{o as provideEventBus,u as useEventBus};
